<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Retro Terminal OS</title>
  <style>
    body {
      margin:0;
      height:100vh;
      background:black;
      font-family: 'Courier New', monospace;
      overflow:hidden;
      color:#33ff33;
      transition: background 1s, color 1s;
    }

    /* THEMES */
    body.synthwave {
      background:black;
      color:#33ff33;
    }
    body.industrial {
      background:#111 url('https://www.transparenttextures.com/patterns/dark-matter.png');
      color:#ff9933;
    }

    /* Terminal */
    #terminal {
      display:none;
      padding:20px;
      height:100vh;
      width:100vw;
      font-size:1.2em;
      white-space: pre-wrap;
      overflow-y:auto;
    }
    .input-line { display:flex; margin-top:0.2em; }
    .prompt { margin-right:10px; }
    #commandInput {
      background:none;
      border:none;
      color:inherit;
      outline:none;
      font-size:1.2em;
      flex:1;
    }

    /* Pages */
    .page {
      display:none;
      height:100vh;
      width:100vw;
      flex-direction:column;
      justify-content:center;
      align-items:center;
      font-size:1.2em;
    }
    .backBtn {
      margin-top:20px;
      padding:6px 12px;
      border:none;
      cursor:pointer;
      font-weight:bold;
      background:rgba(255,255,255,0.2);
      color:inherit;
    }
    .backBtn:hover { background:rgba(255,255,255,0.4); }

    /* Design Page */
    #designPage img { 
      max-width:80vw; 
      max-height:60vh; 
      border:3px solid currentColor;
    }

    /* Nuclear schematic */
    #reactorCanvas {
      background:#000;
      border:2px solid currentColor;
    }

    /* Solar system */
    #solarCanvas {
      background:#000;
      border:2px solid currentColor;
    }

    /* Music */
    .music-options button {
      display:block;
      margin:8px;
      padding:8px 14px;
      background:rgba(255,255,255,0.2);
      color:inherit;
      border:none;
      cursor:pointer;
    }
    .music-options button:hover {
      background:rgba(255,255,255,0.4);
    }

    /* Loading Overlay for evolve */
    #loadingOverlay {
      display:none;
      position:absolute;
      top:0; left:0;
      width:100vw; height:100vh;
      background:black;
      justify-content:center;
      align-items:center;
      color:#ff9933;
      font-size:2em;
      flex-direction:column;
      z-index:100;
    }
    .bar { 
      width:300px; height:25px; 
      border:1px solid currentColor; 
      margin-top:20px;
      position:relative;
      overflow:hidden;
    }
    .fill {
      height:100%; width:0;
      background:currentColor;
      animation: fillBar 4s forwards;
    }
    @keyframes fillBar {
      to { width:100%; }
    }
  </style>
</head>
<body class="synthwave">
  <div id="terminal"></div>

  <!-- Pages -->
  <div id="designPage" class="page">
    <img id="photo" alt="Design photo">
    <button class="backBtn" onclick="returnToTerminal()">← Back</button>
  </div>

  <div id="portalPage" class="page">
    <h2>Calendar & Reminders</h2>
    <textarea id="calendar" style="width:60vw;height:50vh;"></textarea>
    <button class="backBtn" onclick="returnToTerminal()">← Back</button>
  </div>

  <div id="logPage" class="page">
    <h2>Visitor Log (IPs)</h2>
    <pre id="logOutput"></pre>
    <button class="backBtn" onclick="returnToTerminal()">← Back</button>
  </div>

  <div id="nuclearPage" class="page">
    <h2>Nuclear Reactor Simulation</h2>
    <canvas id="reactorCanvas" width="500" height="500"></canvas>
    <pre id="reactorStats"></pre>
    <button class="backBtn" onclick="returnToTerminal()">← Back</button>
  </div>

  <div id="solarPage" class="page">
    <h2>Solar System Simulation</h2>
    <canvas id="solarCanvas" width="600" height="600"></canvas>
    <button class="backBtn" onclick="returnToTerminal()">← Back</button>
  </div>

  <div id="musicPage" class="page">
    <h2>Music Player</h2>
    <div class="music-options">
      <button onclick="playMusic('https://www.youtube.com/embed/jfKfPfyJRdk?autoplay=1')">Lofi Girl</button>
      <button onclick="playMusic('https://www.youtube.com/embed/5qap5aO4i9A?autoplay=1')">Chillhop</button>
      <button onclick="playMusic('https://www.youtube.com/embed/7NOSDKb0HlU?autoplay=1')">College Radio</button>
    </div>
    <iframe id="musicFrame" width="560" height="315" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>
    <button class="backBtn" onclick="returnToTerminal()">← Back</button>
  </div>

  <!-- Loading Overlay -->
  <div id="loadingOverlay">
    <div>[▓▓░░░░░░░░] EVOLVING...</div>
    <div class="bar"><div class="fill"></div></div>
  </div>

  <script>
    const terminal = document.getElementById('terminal');
    const pages = {
      design: document.getElementById('designPage'),
      portal: document.getElementById('portalPage'),
      log: document.getElementById('logPage'),
      nuclear: document.getElementById('nuclearPage'),
      solar: document.getElementById('solarPage'),
      music: document.getElementById('musicPage')
    };
    let termText = "";
    const commandInput = document.createElement('input');
    commandInput.type = 'text';
    commandInput.id = 'commandInput';

    const introLines = [
      "Retro Terminal OS v2.0",
      "Type 'help' for a list of commands."
    ];

    function showTerminal() {
      terminal.style.display = 'block';
      typeWriter(introLines);
    }

    function typeWriter(lines, idx = 0, charIdx = 0) {
      if (idx >= lines.length) {
        termText += "\n> ";
        terminal.textContent = termText;
        terminal.appendChild(commandInput);
        commandInput.focus();
        return;
      }
      const line = lines[idx];
      if (charIdx < line.length) {
        termText += line.charAt(charIdx);
        terminal.textContent = termText;
        charIdx++;
        setTimeout(()=> typeWriter(lines, idx, charIdx), 40);
      } else {
        termText += "\n";
        setTimeout(()=> typeWriter(lines, idx+1, 0), 200);
      }
    }
    showTerminal();

    function returnToTerminal() {
      for (let p in pages) pages[p].style.display = 'none';
      terminal.style.display = 'block';
      commandInput.focus();
    }

    function runCommand(cmd) {
      cmd = cmd.toLowerCase();
      if (cmd === "help") {
        termText += "Available commands:\n";
        termText += "design, portal, log, nuclear, solar, music, evolve, synthwave, clear\n> ";
      }
      else if (cmd === "clear") {
        termText = "";
      }
      else if (cmd === "design") {
        terminal.style.display = 'none';
        pages.design.style.display = 'flex';
        document.getElementById('photo').src = `https://source.unsplash.com/random/800x600/?interior&sig=${Date.now()}`;
      }
      else if (cmd === "portal") {
        terminal.style.display = 'none';
        pages.portal.style.display = 'flex';
      }
      else if (cmd === "log") {
        terminal.style.display = 'none';
        pages.log.style.display = 'flex';
        document.getElementById('logOutput').textContent = "Visitor IPs:\n192.168.0.14\n192.168.0.22\n83.244.55.17";
      }
      else if (cmd === "nuclear") {
        terminal.style.display = 'none';
        pages.nuclear.style.display = 'flex';
        startReactor();
      }
      else if (cmd === "solar") {
        terminal.style.display = 'none';
        pages.solar.style.display = 'flex';
        startSolar();
      }
      else if (cmd === "music") {
        terminal.style.display = 'none';
        pages.music.style.display = 'flex';
      }
      else if (cmd === "evolve") {
        evolveTheme();
      }
      else if (cmd === "synthwave") {
        document.body.classList.remove('industrial');
        document.body.classList.add('synthwave');
        termText += "[SYSTEM] Switched to Synthwave mode\n> ";
      }
      else {
        termText += cmd + ": command not found\n> ";
      }
      terminal.textContent = termText;
      terminal.appendChild(commandInput);
      commandInput.value = "";
    }

    commandInput.addEventListener('keydown', (e) => {
      if (e.key === "Enter") {
        const cmd = commandInput.value.trim();
        termText += cmd + "\n";
        runCommand(cmd);
      }
    });

    /* THEME EVOLVE */
    function evolveTheme(){
      const overlay = document.getElementById('loadingOverlay');
      overlay.style.display = 'flex';
      setTimeout(()=>{
        overlay.style.display = 'none';
        document.body.classList.remove('synthwave');
        document.body.classList.add('industrial');
        termText += "[SYSTEM] Industrial Protocol Online\n> ";
        terminal.textContent = termText;
        terminal.appendChild(commandInput);
      },4000);
    }

    /* MUSIC */
    function playMusic(url){
      document.getElementById('musicFrame').src = url;
    }

    /* Nuclear Reactor */
    let reactorInterval;
    function startReactor(){
      const canvas = document.getElementById('reactorCanvas');
      const ctx = canvas.getContext('2d');
      let temp = 300, pressure = 100, rods = 50, coolant = 50;

      if(reactorInterval) clearInterval(reactorInterval);
      reactorInterval = setInterval(()=>{
        // simulate
        temp += (50-rods)*0.1 - coolant*0.05;
        pressure = temp/3 + coolant;
        // draw
        ctx.clearRect(0,0,500,500);
        // core
        let color = temp<400?"blue":temp<600?"green":temp<800?"orange":"red";
        ctx.fillStyle=color;
        ctx.beginPath();
        ctx.arc(250,250,80,0,Math.PI*2);
        ctx.fill();
        // rods
        ctx.fillStyle="grey";
        for(let i=0;i<4;i++){
          ctx.fillRect(180+i*40, 170, 10, rods);
        }
        // coolant loop
        ctx.strokeStyle="cyan";
        ctx.lineWidth=4;
        ctx.beginPath();
        ctx.arc(250,250,150,0,Math.PI*2);
        ctx.stroke();
        ctx.lineWidth=2;
        ctx.strokeStyle="cyan";
        ctx.setLineDash([10,10]);
        ctx.stroke();
        ctx.setLineDash([]);
        document.getElementById('reactorStats').textContent =
          `Temp: ${temp.toFixed(1)}K\nPressure: ${pressure.toFixed(1)} Pa\nControl Rods: ${rods}%\nCoolant Flow: ${coolant}%`;
      },200);
    }

    /* Solar System */
let solarAnim, fastForward = false;
function startSolar(){
  const canvas = document.getElementById('solarCanvas');
  const ctx = canvas.getContext('2d');
  let cx=300, cy=300;

  // Planet data (AU scaled → pixels, approx)
  const planets = [
    {name:"Mercury", r:60, period:88, color:"grey"},
    {name:"Venus",   r:100, period:225, color:"orange"},
    {name:"Earth",   r:140, period:365, color:"blue"},
    {name:"Mars",    r:180, period:687, color:"red"},
    {name:"Jupiter", r:240, period:4333, color:"tan"},
    {name:"Saturn",  r:300, period:10759, color:"goldenrod"},
    {name:"Uranus",  r:360, period:30687, color:"lightblue"},
    {name:"Neptune", r:420, period:60190, color:"purple"}
  ];

  if(solarAnim) cancelAnimationFrame(solarAnim);

  function draw(){
    ctx.clearRect(0,0,600,600);
    // draw sun
    ctx.fillStyle="yellow";
    ctx.beginPath();
    ctx.arc(cx,cy,20,0,Math.PI*2);
    ctx.fill();

    const now = new Date();
    const daysSinceEpoch = (now - new Date("2000-01-01")) / (1000*60*60*24);
    let multiplier = fastForward ? 1000 : 1;

    planets.forEach(p=>{
      // orbit angle
      let angle = 2*Math.PI * (daysSinceEpoch * multiplier / p.period);
      let x = cx + Math.cos(angle)*p.r;
      let y = cy + Math.sin(angle)*p.r;

      // orbit path
      ctx.strokeStyle="rgba(255,255,255,0.2)";
      ctx.beginPath();
      ctx.arc(cx,cy,p.r,0,Math.PI*2);
      ctx.stroke();

      // planet
      ctx.fillStyle=p.color;
      ctx.beginPath();
      ctx.arc(x,y,6,0,Math.PI*2);
      ctx.fill();
    });

    solarAnim=requestAnimationFrame(draw);
  }
  draw();

  // toggle fast forward
  document.addEventListener('keydown',(e)=>{
    if(e.key.toLowerCase()==='f'){
      fastForward=!fastForward;
    }
  });
}

  </script>
</body>
</html>
